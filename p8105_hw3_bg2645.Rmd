---
title: "p8105_hw3_bg2645"
author: "Bing Bing Guo"
date: "10/9/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Question 1: 
```{r} 
library(tidyverse)
library(p8105.datasets)
library(dplyr)
library(viridis)
library(ggridges) 
library(patchwork)
data("instacart")
```

* There were `r nrow(instacart)` observations and `r ncol(instacart)` variables in the `instacart` dataset. 
* The key variables in the `instacart` dataset were the names 

```{r} 
instacart %>%
  count(aisle_id, name = "n")%>%
arrange(desc(n))
```
* There are 134 aisles in instacart, the most ordered items are from aisle 83, 24, and 123 respectively - in which aisle 83 had the most ordered items out out of all the aisles. 


```{r}
instacart %>%
group_by(aisle) %>%
summarize(n_aisle = n()) %>%
filter(n_aisle> 10000) %>%
arrange((desc(n_aisle))) %>%
ggplot(aes(x = aisle , y = n_aisle,color=aisle)) + geom_point() + 
labs(
    title = "Number of Items Ordered in Each Aisle", 
    x = "Aisle",
    y = "Number of Items Ordered (n)",
    caption = "This plot shows the number of items ordered in each aisle, limited to aisles with more than 10,000 items ordered" ) + 
viridis::scale_color_viridis(discrete = TRUE) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, size = 14),   
    plot.caption = element_text(hjust = 0, face = "italic"), 
    legend.position = "none", 
    axis.text.x = element_text(angle=70, hjust=1) ) 
```

```{r} 
top3_data = instacart %>%
filter(aisle %in% c("baking ingredients", "dog food care","packaged vegetables fruits")) %>%
group_by(aisle, product_name) %>%
summarize(n = n()) %>%
top_n(3) %>%
arrange(desc(n)) %>%
knitr::kable()
top3_data
```

```{r} 
instacart %>%
select(product_name, order_dow, order_hour_of_day) %>%
group_by(product_name, order_dow) %>%
summarize(mean_hour = mean(order_hour_of_day)) %>%
mutate(order_dow = recode(order_dow, "0" = "Sunday", "1" = "Monday", "2" = "Tuesday", "3" = "Wednesday", "4" = "Thursday", "5" = "Friday", "6" = "Saturday"))  %>%
filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream"))  %>%
pivot_wider(names_from = "order_dow", values_from = "mean_hour") %>%
knitr::kable(digits = 3)
```
## Question 2: 
```{r}
data("brfss_smart2010") 
```

```{r} 
clean_brfss_data = brfss_smart2010 %>% 
janitor::clean_names() %>% 
separate(locationdesc, into = c("state", "county"), sep=3) %>% 
select(-locationabbr) %>% 
mutate(
topic = "Overall Health", 
response = forcats::fct_relevel(response, c("Poor", "Fair", "Good", "Very Good", "Excellent")) )  %>%
filter(response %in% c("Poor", "Fair", "Good", "Very Good", "Excellent")) 
clean_brfss_data
```

```{r} 
clean_brfss_data %>% 
filter(year == 2002) %>%
group_by (state)  %>%
summarize(n_locations = n_distinct(county)) %>%
filter(n_locations >= 7) %>%
arrange(n_locations) 
```
* Pennslyvania, Massachusetts, New Jersey, Connecticut, Florida, North Carolina were all observed at 7 or more locations in 2002.  
```{r}
clean_brfss_data %>% 
filter(year == 2010) %>%
group_by (state)  %>%
summarize(n_locations = n_distinct(county)) %>%
filter(n_locations >= 7) %>%
arrange(n_locations)
```
* Florida, New Jersey, Texas, California, Maryland, North Carolina, Nebraska, Washington, Massachusettes, New York, Ohio, Colorodo, Pennsylvania, South Carolina were all observed at 7 or more locations in 2002. 

```{r}
excellent_data=clean_brfss_data %>%
filter(response=="Excellent")%>% 
group_by(state, response,  year) %>% 
summarize(mean_value = mean(data_value)) 
excellent_data
```

```{r}
excellent_data %>%
ggplot(aes(x = year , y = mean_value, color=state)) + geom_line() + 
labs(
    title = "Average Value Over Time within a State", 
    x = "Year",
    y = "Average Value") + 
viridis::scale_color_viridis(discrete = TRUE) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, size = 14), 
    axis.text.x = element_text(angle=70, hjust=1))
```

Make a “spaghetti” plot of this average value over time within a state (that is, make a plot showing a line for each state across years – the geom_line geometry and group aesthetic will help).

```{r} 

```

Make a two-panel plot showing, for the years 2006, and 2010, distribution of data_value for responses (“Poor” to “Excellent”) among locations in NY State

## Question 3: 
```{r} 
```